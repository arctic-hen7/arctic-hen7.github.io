<!DOCTYPE html><html lang=en-US class=light><head><base href=https://arctic-hen7.github.io/><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=stylesheet href=.perseus/static/tailwind.css><script type=module>window.__PERSEUS_RENDER_CFG = `{"contact":"contact","tag/productivity":"tag","tag/frameworks":"tag","posts":"posts","tag/webdev":"tag","tag/tutorial":"tag","post/496eb33a-c137-4afa-a03c-2f165d522a98":"post","tag/habits":"tag","tag/commentary":"tag","tag/design":"tag","tag/overview":"tag","post/5633d380-fede-4c98-8c31-fc21610e4e5e":"post","post/eede1692-be41-404a-93e8-d4b048db21bc":"post","tag/rust":"tag","tag/self-development":"tag","post/7adca2f7-ab95-41e1-8d0d-4bbc020ca018":"post","tag/explanation":"tag","tag/perseus":"tag","tag/quickfix":"tag","post/03ab02d7-f196-46d7-a1f9-d0c951245889":"post","tag/linux":"tag","shortform":"shortform","post/c26d230f-a546-4da0-be18-9857e168d7b9":"post","tag/economics":"tag","post/4726b90d-613e-4a45-b419-44cd6ec887a4":"post","tag/dev":"tag","post/bbb3e057-0f97-45a2-aa05-e791802fceee":"post","":"","tag/programming":"tag","tag/open-source-admin":"tag","tag/ai":"tag","tag/css":"tag","about":"about"}`;

        import init from "https://arctic-hen7.github.io/.perseus/bundle.js";
        async function main() {
            await init("https://arctic-hen7.github.io/.perseus/bundle.wasm");
        }
        main();

        
        

window.__PERSEUS_GLOBAL_STATE = `{"motd":"\\"[W]e should be able to do anything, but want to do only what is good\\" — Montaigne 1.26\\n","woke_up_on_time":true}`;</script><meta itemprop=__perseus_head_boundary><title>How to Fix a Broken Ubuntu Machine After Uninstalling Rollup | The Arctic Circle</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css><link rel=stylesheet href=.perseus/static/org.css><meta name=description content="A pretty simple fix to a downright weird problem."><script>
window.__PERSEUS_INITIAL_STATE = `{"author":"Me","contents":"<p>\\nThis post details one of the strangest failures I&rsquo;ve ever seen in Ubuntu and how to fix it. For me, this occurred after deleting <code>rollup</code>, but it may have been something else for you! Please leave a comment if you&rsquo;ve had this problem and if you have any idea how it works!\\n</p>\\n\\n<div id=\\"outline-container-org2a51963\\" class=\\"outline-2\\">\\n<h2 id=\\"org2a51963\\">Scenario</h2>\\n<div class=\\"outline-text-2\\" id=\\"text-org2a51963\\">\\n<p>\\nI was working on <a href=\\"https://github.com/arctic-hen7/perseus\\">Perseus</a> this morning, specifically removing the dependency on Rollup for the project. So, I naturally decided to remove Rollup completely from my system to test that there was no longer any dependency.\\n</p>\\n\\n<p>\\nSo, I did what made sense; <code>yarn global remove rollup</code>. And, to my dismay, <code>rollup</code> still worked as a command. I ran <code>which rollup</code> to find the exact location of the binary, which was in <code>~/.yarn/bin</code>. And then I did what you should <i>never</i> do. I decided to delete is manually with <code>rm</code>.\\n</p>\\n\\n<p>\\nNow it&rsquo;s worth noting that around this time my system had become very slow due to some kind of swap glitch, and so I decided to restart, having just deleted a binary manually. Now it&rsquo;s worth noting that I installed <code>rollup</code> through <code>yarn</code>, which I installed through <code>npm</code>, which I installed through <code>nvm</code> (Node version manager), which I installed with <code>curl</code>. That&rsquo;s <b>five</b> degrees of separation from anything that should be remotely system-critical, hence my confusion at what happened next.\\n</p>\\n\\n<p>\\nSo, booting my computer back up, everything was working as normal. I got to the login screen fine, the fan still whirring a bit from the swap glitch, and I typed in my password as usual. Then, as my desktop loaded, my mouse froze. I could not interact with my system in any way whatsoever. I rebooted <b>three</b> times, the exact same thing.\\n</p>\\n</div>\\n</div>\\n\\n<div id=\\"outline-container-org33c099d\\" class=\\"outline-2\\">\\n<h2 id=\\"org33c099d\\">The Solution</h2>\\n<div class=\\"outline-text-2\\" id=\\"text-org33c099d\\">\\n<p>\\nMy first thought was to change my login shell, which is <code>fish</code>, to something more mainstream like <code>bash</code>, as that could have some <code>rollup</code> dependency that might be causing a system hang. I did that with recovery mode, which I&rsquo;ll explain now (you&rsquo;ll need this), but to no avail.\\n</p>\\n</div>\\n\\n<div id=\\"outline-container-org2c92299\\" class=\\"outline-3\\">\\n<h3 id=\\"org2c92299\\">Ubuntu Recovery Mode</h3>\\n<div class=\\"outline-text-3\\" id=\\"text-org2c92299\\">\\n<p>\\nUbuntu has a very helpful boot mode called recovery mode that you can use to repair a broken system. You&rsquo;ll need to be able to boot your system for this, which was fine for me because it was a post-login issue.\\n</p>\\n\\n<p>\\nYou can access recovery mode by spamming <code>Esc</code> as your computer boots to stop UEFI fast boot, and then press <code>Enter</code> to continue boot. Immediately after that, hold down <code>Shift</code> (don&rsquo;t spam it) to get the GRUB menu, the bootloader. Then go down to something like <code>Advanced Options</code>, and then select <code>Recovery Mode</code> with the newest kernel (for this issue at least, but this can also be used to revert broken kernel upgrades). You should now be taken to a terminal-only screen (where you&rsquo;ll need to decrypt your hard drive and the like), and then you&rsquo;ll get a menu of options. This will boot your filesystem read-only, so it&rsquo;s practically impossible to do any damage without changing that, which you can do in 20.04 and later by selecting <code>Enable networking</code> and pressing <code>Enter</code>. Then press the option that lets you drop into a root shell, and you now have a root terminal on your system!\\n</p>\\n\\n<p>\\n<i>Aside: THIS is why you should encrypt your hard drive! Otherwise, yeah, anyone could use this to do <a href=\\"https://r3xnation.wordpress.com/2016/11/01/how-to-hack-into-ubuntuany-version/\\">anything they want</a> (weird link but good explanation) to your system.</i>\\n</p>\\n</div>\\n</div>\\n\\n<div id=\\"outline-container-orgc553a6b\\" class=\\"outline-3\\">\\n<h3 id=\\"orgc553a6b\\">Actually Fixing It</h3>\\n<div class=\\"outline-text-3\\" id=\\"text-orgc553a6b\\">\\n<p>\\nAfter logging into a hung desktop with 10 minutes until I was needed on a Zoom meeting, I booted back into recovery mode, enabled networking, and switched to my user account with <code>su arctic_hen7</code>. I confirmed that <code>rollup</code> didn&rsquo;t exist, and then found that <code>yarn</code> didn&rsquo;t either. That was weird, and neither did <code>node</code>! In case you&rsquo;re thinking of weird <code>fish</code> stuff with loading custom binaries, I was in <code>bash</code> at this point. I still have no idea how deleting a binary manually managed to corrupt the entire JavaScript stack on my computer.\\n</p>\\n\\n<p>\\nNevertheless, I reinstalled Node using <code>nvm</code> (which I already had installed), reinstalled <code>yarn</code>, and then ran <code>yarn global add rollup</code> for good measure. I then tried popping into <code>fish</code> to see how it was going. I use <code>fish</code> with Starship, and it was telling me that the latter wasn&rsquo;t working. Two minutes until that Zoom meeting by the way.\\n</p>\\n\\n<p>\\nI frantically rebooted and crossed my fingers, noting that my shell was still set to <code>bash</code> in case Starship was still an issue. And it worked! Until a spontaneous logout 12 minutes later, which I think was unrelated, because it didn&rsquo;t happen again and still hasn&rsquo;t yet (I am so expecting one as a write this&#x2026;).\\n</p>\\n\\n<p>\\nAfter my Zoom meeting, I then tried using <code>fish</code> again: errors were gone. I assume Starship was trying to do something that&rsquo;s not allowed in recovery mode, but I can&rsquo;t yet remember the error message, so I have no idea what.\\n</p>\\n</div>\\n</div>\\n</div>\\n\\n<div id=\\"outline-container-orga0dc3df\\" class=\\"outline-2\\">\\n<h2 id=\\"orga0dc3df\\">Closing Words</h2>\\n<div class=\\"outline-text-2\\" id=\\"text-orga0dc3df\\">\\n<p>\\nSo, that was one of the weirdest issues I&rsquo;ve ever encountered in all my time using Linux, but thankfully it was a pretty easy fix. I have still found no documentation online about this, so hopefully this helps someone at some point in the future!\\n</p>\\n\\n<p>\\nAlso, if you&rsquo;ve had this issue, please let me know in the comments!\\n</p>\\n\\n<p>\\nOh, and the lesson from all this is to <b>NEVER MANUALLY DELETE BINARIES!!!</b>\\n</p>\\n</div>\\n</div>","date":"2021-09-15","description":"A pretty simple fix to a downright weird problem.","id":"bbb3e057-0f97-45a2-aa05-e791802fceee","series":null,"tags":["linux","quickfix"],"title":"How to Fix a Broken Ubuntu Machine After Uninstalling Rollup","toc":"<div id=\\"table-of-contents\\" role=\\"doc-toc\\">\\n\\n<div id=\\"text-table-of-contents\\" role=\\"doc-toc\\">\\n<ul>\\n<li><a href=\\"post/bbb3e057-0f97-45a2-aa05-e791802fceee#org2a51963\\">Scenario</a></li>\\n<li><a href=\\"post/bbb3e057-0f97-45a2-aa05-e791802fceee#org33c099d\\">The Solution</a>\\n<ul>\\n<li><a href=\\"post/bbb3e057-0f97-45a2-aa05-e791802fceee#org2c92299\\">Ubuntu Recovery Mode</a></li>\\n<li><a href=\\"post/bbb3e057-0f97-45a2-aa05-e791802fceee#orgc553a6b\\">Actually Fixing It</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"post/bbb3e057-0f97-45a2-aa05-e791802fceee#orga0dc3df\\">Closing Words</a></li>\\n</ul>\\n</div>\\n</div>"}`;
window.__PERSEUS_INITIAL_WIDGET_STATES = `{}`;
window.__PERSEUS_TRANSLATIONS = ``;</script><meta itemprop=__perseus_head_end><script>//</script><body class="bg-black text-white"><div id=root><header data-hk=1.11 class="w-full mb-20 backdrop-blur-lg {}"><div data-hk=1.12 class="sm:p-2 flex justify-between xl:justify-center items-center"><a data-hk=1.13 class="justify-self-start self-center m-3 ml-5 text-lg sm:text-xl text-bold title-font"href=/>The Arctic Site</a><div data-hk=1.14 class="xl:w-[38rem] 2xl:w-[55rem] 3xl:w-[70rem]"></div><div data-hk=1.15 class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6"><div data-hk=1.16 class=tham-box><div data-hk=1.17 class="tham-inner bg-white"></div></div></div><nav data-hk=1.18 class="hidden md:flex"><ul data-hk=1.19 class="mr-5 flex"><li data-hk=2.0 class="m-3 p-1"><a data-hk=2.1 href>Home</a><li data-hk=2.2 class="m-3 p-1"><a data-hk=2.3 href=about>About</a><li data-hk=2.4 class="m-3 p-1"><a data-hk=2.5 href=posts>The Arctic Circle</a><li data-hk=2.6 class="m-3 p-1"><a data-hk=2.7 href=shortform>The Ice Floes</a></ul></nav></div><nav data-hk=1.20 id=mobile_nav_menu class="sm:p-2 md:hidden w-full text-center justify-center hidden"><ul data-hk=1.21 class=mr-5><li data-hk=3.0 class="m-3 p-1"><a data-hk=3.1 href>Home</a><li data-hk=3.2 class="m-3 p-1"><a data-hk=3.3 href=about>About</a><li data-hk=3.4 class="m-3 p-1"><a data-hk=3.5 href=posts>The Arctic Circle</a><li data-hk=3.6 class="m-3 p-1"><a data-hk=3.7 href=shortform>The Ice Floes</a></ul></nav></header><main data-hk=1.22 class="mt-14 xs:mt-16 sm:mt-20 lg:mt-24"><div data-hk=1.0 class="flex flex-col lg:flex-row-reverse justify-center items-center w-full px-4 sm:px-8 lg:px-10"><h1 data-hk=1.1 class="text-4xl my-3 lg:hidden">How to Fix a Broken Ubuntu Machine After Uninstalling Rollup</h1><nav data-hk=1.2 class="styled-prose lg:sticky self-start top-14 xs:top-16 sm:top-20 lg:top-24 max-w-md max-h-[63vh] overflow-y-auto border-l border-neutral-600 pl-4 lg:mx-4 py-3"><div data-hk=1.3 class=max-w-sm><div id=table-of-contents role=doc-toc><div id=text-table-of-contents role=doc-toc><ul><li><a href=post/bbb3e057-0f97-45a2-aa05-e791802fceee#org2a51963>Scenario</a><li><a href=post/bbb3e057-0f97-45a2-aa05-e791802fceee#org33c099d>The Solution</a> <ul><li><a href=post/bbb3e057-0f97-45a2-aa05-e791802fceee#org2c92299>Ubuntu Recovery Mode</a><li><a href=post/bbb3e057-0f97-45a2-aa05-e791802fceee#orgc553a6b>Actually Fixing It</a></ul><li><a href=post/bbb3e057-0f97-45a2-aa05-e791802fceee#orga0dc3df>Closing Words</a></ul></div></div></div></nav><div data-hk=1.4 class=min-w-0><h1 data-hk=1.5 class="text-4xl my-3 text-center hidden lg:block">How to Fix a Broken Ubuntu Machine After Uninstalling Rollup</h1><div data-hk=1.6 class="styled-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl min-w-0 min-h-0 mb-6"><p>This post details one of the strangest failures I’ve ever seen in Ubuntu and how to fix it. For me, this occurred after deleting <code>rollup</code>, but it may have been something else for you! Please leave a comment if you’ve had this problem and if you have any idea how it works!<div id=outline-container-org2a51963 class=outline-2><h2 id=org2a51963>Scenario</h2><div class=outline-text-2 id=text-org2a51963><p>I was working on <a href=https://github.com/arctic-hen7/perseus>Perseus</a> this morning, specifically removing the dependency on Rollup for the project. So, I naturally decided to remove Rollup completely from my system to test that there was no longer any dependency.<p>So, I did what made sense; <code>yarn global remove rollup</code>. And, to my dismay, <code>rollup</code> still worked as a command. I ran <code>which rollup</code> to find the exact location of the binary, which was in <code>~/.yarn/bin</code>. And then I did what you should <i>never</i> do. I decided to delete is manually with <code>rm</code>.<p>Now it’s worth noting that around this time my system had become very slow due to some kind of swap glitch, and so I decided to restart, having just deleted a binary manually. Now it’s worth noting that I installed <code>rollup</code> through <code>yarn</code>, which I installed through <code>npm</code>, which I installed through <code>nvm</code> (Node version manager), which I installed with <code>curl</code>. That’s <b>five</b> degrees of separation from anything that should be remotely system-critical, hence my confusion at what happened next.<p>So, booting my computer back up, everything was working as normal. I got to the login screen fine, the fan still whirring a bit from the swap glitch, and I typed in my password as usual. Then, as my desktop loaded, my mouse froze. I could not interact with my system in any way whatsoever. I rebooted <b>three</b> times, the exact same thing.</div></div><div id=outline-container-org33c099d class=outline-2><h2 id=org33c099d>The Solution</h2><div class=outline-text-2 id=text-org33c099d><p>My first thought was to change my login shell, which is <code>fish</code>, to something more mainstream like <code>bash</code>, as that could have some <code>rollup</code> dependency that might be causing a system hang. I did that with recovery mode, which I’ll explain now (you’ll need this), but to no avail.</div><div id=outline-container-org2c92299 class=outline-3><h3 id=org2c92299>Ubuntu Recovery Mode</h3><div class=outline-text-3 id=text-org2c92299><p>Ubuntu has a very helpful boot mode called recovery mode that you can use to repair a broken system. You’ll need to be able to boot your system for this, which was fine for me because it was a post-login issue.<p>You can access recovery mode by spamming <code>Esc</code> as your computer boots to stop UEFI fast boot, and then press <code>Enter</code> to continue boot. Immediately after that, hold down <code>Shift</code> (don’t spam it) to get the GRUB menu, the bootloader. Then go down to something like <code>Advanced Options</code>, and then select <code>Recovery Mode</code> with the newest kernel (for this issue at least, but this can also be used to revert broken kernel upgrades). You should now be taken to a terminal-only screen (where you’ll need to decrypt your hard drive and the like), and then you’ll get a menu of options. This will boot your filesystem read-only, so it’s practically impossible to do any damage without changing that, which you can do in 20.04 and later by selecting <code>Enable networking</code> and pressing <code>Enter</code>. Then press the option that lets you drop into a root shell, and you now have a root terminal on your system!<p><i>Aside: THIS is why you should encrypt your hard drive! Otherwise, yeah, anyone could use this to do <a href=https://r3xnation.wordpress.com/2016/11/01/how-to-hack-into-ubuntuany-version/>anything they want</a> (weird link but good explanation) to your system.</i></div></div><div id=outline-container-orgc553a6b class=outline-3><h3 id=orgc553a6b>Actually Fixing It</h3><div class=outline-text-3 id=text-orgc553a6b><p>After logging into a hung desktop with 10 minutes until I was needed on a Zoom meeting, I booted back into recovery mode, enabled networking, and switched to my user account with <code>su arctic_hen7</code>. I confirmed that <code>rollup</code> didn’t exist, and then found that <code>yarn</code> didn’t either. That was weird, and neither did <code>node</code>! In case you’re thinking of weird <code>fish</code> stuff with loading custom binaries, I was in <code>bash</code> at this point. I still have no idea how deleting a binary manually managed to corrupt the entire JavaScript stack on my computer.<p>Nevertheless, I reinstalled Node using <code>nvm</code> (which I already had installed), reinstalled <code>yarn</code>, and then ran <code>yarn global add rollup</code> for good measure. I then tried popping into <code>fish</code> to see how it was going. I use <code>fish</code> with Starship, and it was telling me that the latter wasn’t working. Two minutes until that Zoom meeting by the way.<p>I frantically rebooted and crossed my fingers, noting that my shell was still set to <code>bash</code> in case Starship was still an issue. And it worked! Until a spontaneous logout 12 minutes later, which I think was unrelated, because it didn’t happen again and still hasn’t yet (I am so expecting one as a write this…).<p>After my Zoom meeting, I then tried using <code>fish</code> again: errors were gone. I assume Starship was trying to do something that’s not allowed in recovery mode, but I can’t yet remember the error message, so I have no idea what.</div></div></div><div id=outline-container-orga0dc3df class=outline-2><h2 id=orga0dc3df>Closing Words</h2><div class=outline-text-2 id=text-orga0dc3df><p>So, that was one of the weirdest issues I’ve ever encountered in all my time using Linux, but thankfully it was a pretty easy fix. I have still found no documentation online about this, so hopefully this helps someone at some point in the future!<p>Also, if you’ve had this issue, please let me know in the comments!<p>Oh, and the lesson from all this is to <b>NEVER MANUALLY DELETE BINARIES!!!</b></div></div></div></div></div><div data-hk=1.7 class="flex flex-col items-center w-full"><ul data-hk=1.8 class="flex justify-center text-center mt-4"><li data-hk=0.0 class=inline-block><a data-hk=0.1 class="block border-4 border-neutral-800 hover:bg-neutral-800 transition-colors duration-150 rounded-lg p-2 px-4 m-2 font-mono flex items-center"href=tag/linux>linux</a><li data-hk=0.2 class=inline-block><a data-hk=0.3 class="block border-4 border-neutral-800 hover:bg-neutral-800 transition-colors duration-150 rounded-lg p-2 px-4 m-2 font-mono flex items-center"href=tag/quickfix>quickfix</a></ul><div data-hk=1.9 class="max-w-prose px-4 mt-8 giscus"></div></div><script data-hk=1.10 src=https://giscus.app/client.js data-repo=arctic-hen7/arctic-hen7.github.io data-repo-id=MDEwOlJlcG9zaXRvcnkzNjc4MTc5Njk= data-category=Comments data-category-id=DIC_kwDOFex08c4CSjuT data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark_high_contrast data-lang=en data-loading=lazy crossorigin async></script></main><footer data-hk=1.23 class="w-full flex justify-center py-5 bg-black"><p data-hk=1.24 class="mx-5 text-center">© arctic-hen7 2021-2022</footer></div><div id=__perseus_popup_error></div>